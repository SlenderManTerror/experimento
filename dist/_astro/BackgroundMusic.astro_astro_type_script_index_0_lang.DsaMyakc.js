console.log("ğŸµ BackgroundMusic component loaded");document.addEventListener("DOMContentLoaded",()=>{console.log("ğŸµ DOM loaded, starting initialization...");const n=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||window.innerWidth<=768;console.log("ğŸµ Device detection:",{userAgent:navigator.userAgent,isMobile:n,windowWidth:window.innerWidth,windowHeight:window.innerHeight});const s=document.getElementById("background-music");s&&(s.style.display="none",console.log("ğŸµ Component audio hidden, using global system"));const e=document.getElementById("music-controls"),d=document.getElementById("drag-handle"),i=document.getElementById("toggle-btn");if(console.log("ğŸµ Found elements:",{musicControls:!!e,dragHandle:!!d,toggleBtn:!!i,windowSize:window.innerWidth+"x"+window.innerHeight}),!e){console.error("ğŸµ musicControls not found!"),n&&(console.log("ğŸµ Attempting to create mobile controls manually..."),C());return}let r=!1,l=!1,h,p,a,g;n?(console.log("ğŸµ Mobile detected - using immediate visibility"),e.classList.add("show"),e.style.transform="translateY(0)",e.style.opacity="1",e.style.visibility="visible",e.style.display="flex"):setTimeout(()=>{e.classList.add("show"),console.log("ğŸµ Desktop controls shown via timeout")},500);function u(){if(l=!l,!i)return;const t=i.querySelector(".chevron-left"),o=i.querySelector(".chevron-right");l?(e&&e.classList.add("minimized"),t&&t.classList.add("hidden"),o&&o.classList.remove("hidden"),i.title="Mostrar controles"):(e&&e.classList.remove("minimized"),t&&t.classList.remove("hidden"),o&&o.classList.add("hidden"),i.title="Ocultar controles"),localStorage.setItem("music-controls-minimized",l.toString()),console.log("ğŸµ Controls",l?"minimized":"expanded")}i&&(i.addEventListener("click",t=>{t.preventDefault(),t.stopPropagation(),u()}),n&&i.addEventListener("touchend",t=>{t.preventDefault(),t.stopPropagation(),u()}),console.log("ğŸµ Toggle listener added"));function y(t){if(r=!0,e&&e.classList.add("dragging"),!e)return;const o=e.getBoundingClientRect();a=o.left,g=o.top;const m=t.touches?t.touches[0].clientX:t.clientX,c=t.touches?t.touches[0].clientY:t.clientY;h=m-a,p=c-g,e.style.left=a+"px",e.style.top=g+"px",e.style.right="auto",e.style.bottom="auto"}function v(t){if(!r)return;const o=t.touches?t.touches[0].clientX:t.clientX,m=t.touches?t.touches[0].clientY:t.clientY;let c=o-h,f=m-p;if(!e)return;const x=e.getBoundingClientRect(),L=window.innerWidth-x.width-10,M=window.innerHeight-x.height-10;c=Math.max(10,Math.min(c,L)),f=Math.max(10,Math.min(f,M)),e.style.left=c+"px",e.style.top=f+"px"}function w(){if(r&&(r=!1,e&&e.classList.remove("dragging"),e)){const t=e.getBoundingClientRect();localStorage.setItem("music-controls-position",JSON.stringify({x:t.left,y:t.top}))}}d&&(d.addEventListener("mousedown",y),n&&d.addEventListener("touchstart",y,{passive:!1}),console.log("ğŸµ Drag listeners added")),document.addEventListener("mousemove",v),document.addEventListener("mouseup",w),n&&(document.addEventListener("touchmove",v,{passive:!1}),document.addEventListener("touchend",w));const b=localStorage.getItem("music-controls-position");if(b)try{const{x:t,y:o}=JSON.parse(b);e.style.left=t+"px",e.style.top=o+"px",e.style.right="auto",e.style.bottom="auto",console.log("ğŸµ Position restored")}catch{console.log("ğŸµ Could not restore position")}localStorage.getItem("music-controls-minimized")==="true"&&u(),console.log("ğŸµ Component ready"),n&&setTimeout(()=>{const t=e.offsetHeight>0&&e.offsetWidth>0;console.log("ğŸµ Mobile visibility check:",{isVisible:t,offsetHeight:e.offsetHeight,offsetWidth:e.offsetWidth,computedDisplay:window.getComputedStyle(e).display,computedOpacity:window.getComputedStyle(e).opacity})},1e3)});function C(){console.log("ğŸµ Creating emergency mobile controls...");const n=document.querySelector(".background-music-container");if(n){const s=document.createElement("div");s.id="music-controls",s.className="music-controls show",s.style.cssText=`
                position: fixed;
                bottom: 20px;
                right: 20px;
                background: rgba(0,0,0,0.8);
                padding: 10px;
                border-radius: 25px;
                display: flex;
                gap: 8px;
                z-index: 99999;
            `,s.innerHTML=`
                <button style="background:none;border:none;color:white;padding:8px;">â–¶ï¸</button>
                <button style="background:none;border:none;color:white;padding:8px;">ğŸ”Š</button>
            `,n.appendChild(s),console.log("ğŸµ Emergency controls created")}}
