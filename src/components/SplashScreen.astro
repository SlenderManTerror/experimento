---
// SplashScreen.astro
export interface Props {
    duration?: number; // Duración en milisegundos
    showLogo?: boolean;
    showProgress?: boolean;
    backgroundColor?: string;
}

const { 
    duration = 3500, 
    showLogo = true, 
    showProgress = true,
    backgroundColor = '#0a1a0a'
} = Astro.props;
---

<div id="splash-screen" class="splash-screen" style={`background-color: ${backgroundColor}`}>
    <!-- Fondo animado con ondas -->
    <div class="background-waves">
        <div class="wave wave-1"></div>
        <div class="wave wave-2"></div>
        <div class="wave wave-3"></div>
    </div>

    <div class="splash-content">
        {showLogo && (
            <div class="splash-logo">
                <div class="logo-container">
                    <!-- Portal effect container -->
                    <div class="portal-container">
                        <!-- Portal rings -->
                        <div class="portal-ring portal-ring-1"></div>
                        <div class="portal-ring portal-ring-2"></div>
                        <div class="portal-ring portal-ring-3"></div>
                        <div class="portal-ring portal-ring-4"></div>
                        <div class="portal-ring portal-ring-5"></div>
                        
                        <!-- Portal energy particles -->
                        <div class="portal-particles">
                            <div class="portal-particle"></div>
                            <div class="portal-particle"></div>
                            <div class="portal-particle"></div>
                            <div class="portal-particle"></div>
                            <div class="portal-particle"></div>
                            <div class="portal-particle"></div>
                            <div class="portal-particle"></div>
                            <div class="portal-particle"></div>
                        </div>
                        
                        <!-- Portal vortex -->
                        <div class="portal-vortex">
                            <div class="vortex-spiral vortex-1"></div>
                            <div class="vortex-spiral vortex-2"></div>
                            <div class="vortex-spiral vortex-3"></div>
                        </div>
                        
                        <!-- Bandera de Esperanto emergiendo del portal -->
                        <div class="esperanto-flag-container portal-emergence">
                            <svg width="160" height="120" viewBox="0 0 160 120" fill="none" class="esperanto-flag-svg">
                                <!-- Bandera base verde -->
                                <rect x="10" y="10" width="140" height="100" 
                                      fill="url(#flagGradient)" 
                                      stroke="url(#greenGradient)" 
                                      stroke-width="2" 
                                      rx="6"/>
                                
                                <!-- Cuadrado blanco en la esquina superior izquierda -->
                                <rect x="10" y="10" width="50" height="50" 
                                      fill="white" 
                                      stroke="url(#greenGradient)" 
                                      stroke-width="1.5" 
                                      rx="3"/>
                                
                                <!-- Estrella verde de Esperanto (5 puntas) - ESTÁTICA -->
                                <g transform="translate(35, 35)">
                                    <path d="M0,-15 L4.5,-4.5 L15,-4.5 L7.5,2 L11,13 L0,7 L-11,13 L-7.5,2 L-15,-4.5 L-4.5,-4.5 Z" 
                                          fill="url(#starGradient)" 
                                          stroke="#047857" 
                                          stroke-width="1.2"/>
                                </g>
                                
                                <!-- Puntos de luz estáticos -->
                                <circle cx="80" cy="25" r="1.5" fill="#10b981" opacity="0.6"/>
                                <circle cx="65" cy="15" r="1" fill="#34d399" opacity="0.5"/>
                                <circle cx="95" cy="35" r="1.5" fill="#6ee7b7" opacity="0.7"/>
                                <circle cx="70" cy="80" r="1" fill="#10b981" opacity="0.4"/>
                                <circle cx="90" cy="70" r="1.5" fill="#34d399" opacity="0.6"/>
                                <circle cx="75" cy="45" r="1" fill="#6ee7b7" opacity="0.5"/>
                                
                                <defs>
                                    <linearGradient id="greenGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                                        <stop offset="0%" style="stop-color:#059669;stop-opacity:1" />
                                        <stop offset="50%" style="stop-color:#10b981;stop-opacity:1" />
                                        <stop offset="100%" style="stop-color:#34d399;stop-opacity:1" />
                                    </linearGradient>
                                    
                                    <linearGradient id="flagGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                                        <stop offset="0%" style="stop-color:#059669;stop-opacity:1" />
                                        <stop offset="100%" style="stop-color:#047857;stop-opacity:1" />
                                    </linearGradient>
                                    
                                    <radialGradient id="starGradient" cx="50%" cy="50%" r="50%">
                                        <stop offset="0%" style="stop-color:#10b981;stop-opacity:1" />
                                        <stop offset="50%" style="stop-color:#059669;stop-opacity:1" />
                                        <stop offset="100%" style="stop-color:#047857;stop-opacity:1" />
                                    </radialGradient>
                                </defs>
                            </svg>
                        </div>
                    </div>
                </div>
                
                <div class="text-container">
                    <h1 class="splash-title">Pelee</h1>
                    <div class="title-underline"></div>
                    <p class="splash-subtitle">La Ciudad Digital</p>
                    <div class="loading-text">Iniciando experiencia...</div>
                </div>
            </div>
        )}
        
        {showProgress && (
            <div class="splash-progress">
                <div class="progress-container">
                    <div class="progress-bar">
                        <div class="progress-fill"></div>
                        <div class="progress-glow"></div>
                    </div>
                    <div class="progress-percentage">0%</div>
                </div>
                
                <div class="status-indicators">
                    <div class="status-item">
                        <div class="status-dot active"></div>
                        <span>Conectando</span>
                    </div>
                    <div class="status-item">
                        <div class="status-dot"></div>
                        <span>Cargando recursos</span>
                    </div>
                    <div class="status-item">
                        <div class="status-dot"></div>
                        <span>Listo</span>
                    </div>
                </div>
            </div>
        )}
    </div>
    
    <!-- Partículas mejoradas -->
    <div class="splash-particles">
        <div class="particle green-1"></div>
        <div class="particle green-2"></div>
        <div class="particle green-3"></div>
        <div class="particle green-4"></div>
        <div class="particle green-5"></div>
        <div class="particle green-6"></div>
        <div class="particle green-7"></div>
        <div class="particle green-8"></div>
    </div>
</div>

<style>
    .splash-screen {
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 9999;
        background: radial-gradient(ellipse at center, rgba(16, 185, 129, 0.1) 0%, rgba(6, 78, 59, 0.8) 50%, rgba(10, 26, 10, 1) 100%);
        overflow: hidden;
        animation: fadeIn 0.8s ease-out;
        font-family: 'AH', serif;
    }

    .background-waves {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        opacity: 0.3;
    }

    .wave {
        position: absolute;
        width: 200%;
        height: 200%;
        background: radial-gradient(circle, rgba(16, 185, 129, 0.1) 0%, transparent 70%);
        border-radius: 50%;
        animation: waveFloat 6s ease-in-out infinite;
    }

    .wave-1 {
        top: -50%;
        left: -50%;
        animation-delay: 0s;
    }

    .wave-2 {
        top: -60%;
        right: -50%;
        animation-delay: 2s;
        animation-duration: 8s;
    }

    .wave-3 {
        bottom: -50%;
        left: -30%;
        animation-delay: 4s;
        animation-duration: 7s;
    }

    .splash-content {
        display: flex;
        flex-direction: column;
        align-items: center;
        text-align: center;
        position: relative;
        z-index: 10;
    }

    .splash-logo {
        margin-bottom: 50px;
        animation: logoEntrance 1.2s ease-out 0.3s both;
        display: flex;
        flex-direction: column;
        align-items: center;
    }

    .logo-container {
        position: relative;
        margin-bottom: 30px;
        display: flex;
        justify-content: center;
        align-items: center;
    }

    .portal-container {
        position: relative;
        width: 300px;
        height: 300px;
        display: flex;
        align-items: center;
        justify-content: center;
        animation: portalContainerEntrance 2s ease-out 0.3s both;
    }

    .portal-ring {
        position: absolute;
        border-radius: 50%;
        border: 3px solid transparent;
        background: linear-gradient(45deg, rgba(16, 185, 129, 0.8), rgba(52, 211, 153, 0.6), rgba(110, 231, 183, 0.4), rgba(16, 185, 129, 0.8));
        background-clip: padding-box;
        animation: portalRotate 4s linear infinite;
        opacity: 0;
        transform: scale(0.1);
        animation-fill-mode: forwards;
    }

    .portal-ring::before {
        content: '';
        position: absolute;
        top: -3px;
        left: -3px;
        right: -3px;
        bottom: -3px;
        background: linear-gradient(45deg, #10b981, #34d399, #6ee7b7, #10b981);
        border-radius: 50%;
        z-index: -1;
        animation: portalGlow 3s ease-in-out infinite alternate;
    }

    .portal-ring-1 {
        width: 280px;
        height: 280px;
        animation: portalRotate 8s linear infinite, portalRingEntrance 1.5s ease-out 0.5s both;
        opacity: 0.3;
    }

    .portal-ring-2 {
        width: 240px;
        height: 240px;
        animation: portalRotate 6s linear infinite reverse, portalRingEntrance 1.5s ease-out 0.7s both;
        opacity: 0.5;
    }

    .portal-ring-3 {
        width: 200px;
        height: 200px;
        animation: portalRotate 4s linear infinite, portalRingEntrance 1.5s ease-out 0.9s both;
        opacity: 0.7;
    }

    .portal-ring-4 {
        width: 160px;
        height: 160px;
        animation: portalRotate 3s linear infinite reverse, portalRingEntrance 1.5s ease-out 1.1s both;
        opacity: 0.6;
    }

    .portal-ring-5 {
        width: 120px;
        height: 120px;
        animation: portalRotate 2s linear infinite, portalRingEntrance 1.5s ease-out 1.3s both;
        opacity: 0.4;
    }

    .portal-particles {
        position: absolute;
        width: 100%;
        height: 100%;
        pointer-events: none;
        animation: portalParticlesEntrance 2s ease-out 1.5s both;
        opacity: 0;
    }

    .portal-particle {
        position: absolute;
        width: 4px;
        height: 4px;
        background: radial-gradient(circle, #10b981, transparent);
        border-radius: 50%;
        animation: portalParticleOrbit 6s linear infinite;
        box-shadow: 0 0 10px #10b981;
    }

    .portal-particle:nth-child(1) {
        animation-delay: 0s;
        animation-duration: 5s;
        left: 50%;
        top: 20%;
    }

    .portal-particle:nth-child(2) {
        animation-delay: 0.7s;
        animation-duration: 7s;
        left: 70%;
        top: 30%;
    }

    .portal-particle:nth-child(3) {
        animation-delay: 1.4s;
        animation-duration: 4s;
        left: 80%;
        top: 50%;
    }

    .portal-particle:nth-child(4) {
        animation-delay: 2.1s;
        animation-duration: 6s;
        left: 70%;
        top: 70%;
    }

    .portal-particle:nth-child(5) {
        animation-delay: 2.8s;
        animation-duration: 5s;
        left: 50%;
        top: 80%;
    }

    .portal-particle:nth-child(6) {
        animation-delay: 3.5s;
        animation-duration: 7s;
        left: 30%;
        top: 70%;
    }

    .portal-particle:nth-child(7) {
        animation-delay: 4.2s;
        animation-duration: 4s;
        left: 20%;
        top: 50%;
    }

    .portal-particle:nth-child(8) {
        animation-delay: 4.9s;
        animation-duration: 6s;
        left: 30%;
        top: 30%;
    }

    .portal-vortex {
        position: absolute;
        width: 100%;
        height: 100%;
        pointer-events: none;
        animation: portalVortexEntrance 2.5s ease-out 1s both;
        opacity: 0;
    }

    .vortex-spiral {
        position: absolute;
        width: 100%;
        height: 100%;
        border-radius: 50%;
        background: conic-gradient(
            from 0deg,
            transparent 0deg,
            rgba(16, 185, 129, 0.1) 45deg,
            rgba(52, 211, 153, 0.2) 90deg,
            rgba(16, 185, 129, 0.3) 135deg,
            rgba(110, 231, 183, 0.2) 180deg,
            rgba(16, 185, 129, 0.1) 225deg,
            transparent 270deg,
            transparent 360deg
        );
        animation: portalVortex 3s linear infinite;
    }

    .vortex-1 {
        animation-duration: 4s;
        opacity: 0.6;
    }

    .vortex-2 {
        animation-duration: 3s;
        animation-direction: reverse;
        opacity: 0.4;
        transform: scale(0.7);
    }

    .vortex-3 {
        animation-duration: 5s;
        opacity: 0.3;
        transform: scale(0.5);
    }

    .portal-emergence {
        position: relative;
        z-index: 10;
        animation: portalEmergenceSmooth 3s ease-out 0.8s both;
        filter: drop-shadow(0 0 30px rgba(16, 185, 129, 0.8));
    }

    .esperanto-star {
        transform-origin: center;
        filter: drop-shadow(0 0 8px rgba(16, 185, 129, 0.8));
    }

    .logo-svg {
        animation: logoFloat 3s ease-in-out infinite;
    }

    .energy-ring {
        position: absolute;
        top: 50%;
        left: 50%;
        border: 2px solid rgba(16, 185, 129, 0.3);
        border-radius: 50%;
        transform: translate(-50%, -50%);
        animation: ringPulse 2s ease-in-out infinite;
    }

    .ring-1 {
        width: 180px;
        height: 140px;
        animation-delay: 0s;
        border-radius: 50%;
    }

    .ring-2 {
        width: 200px;
        height: 160px;
        animation-delay: 0.7s;
        border-radius: 50%;
    }

    .ring-3 {
        width: 220px;
        height: 180px;
        animation-delay: 1.4s;
        border-radius: 50%;
    }

    .text-container {
        animation: textSlideUp 1s ease-out 0.6s both;
    }

    .splash-title {
        font-size: 4rem;
        font-weight: 800;
        background: var(--primary);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        margin: 0 0 15px 0;
        letter-spacing: 3px;
        animation: titleGlow 3s ease-in-out infinite alternate;
        text-shadow: 0 0 50px rgba(16, 185, 129, 0.5);
    }

    .title-underline {
        width: 100px;
        height: 3px;
        background: linear-gradient(90deg, transparent, #10b981, transparent);
        margin: 0 auto 20px;
        animation: underlineExpand 2s ease-out 1s both;
    }

    .splash-subtitle {
        font-size: 1.4rem;
        color: var(--textotabla);
        margin: 0 0 15px 0;
        font-weight: 300;
        letter-spacing: 2px;
        text-shadow: 0 0 20px rgba(52, 211, 153, 0.3);
    }

    .loading-text {
        font-size: 0.9rem;
        color:var(--textotabla);
        font-weight: 400;
        animation: loadingPulse 2s ease-in-out infinite;
    }

    .splash-progress {
        animation: progressSlideUp 1s ease-out 0.9s both;
        width: 100%;
        max-width: 400px;
    }

    .progress-container {
        margin-bottom: 30px;
        position: relative;
    }

    .progress-bar {
        width: 100%;
        height: 6px;
        background: rgba(16, 185, 129, 0.2);
        border-radius: 10px;
        overflow: hidden;
        position: relative;
        margin-bottom: 15px;
        box-shadow: inset 0 0 10px rgba(16, 185, 129, 0.1);
    }

    .progress-fill {
        height: 100%;
        background: linear-gradient(90deg, #10b981, #34d399, #6ee7b7);
        border-radius: 10px;
        animation: progressFill var(--duration, 3.5s) ease-out;
        box-shadow: 0 0 20px rgba(16, 185, 129, 0.6);
        position: relative;
    }

    .progress-glow {
        position: absolute;
        top: 0;
        left: 0;
        height: 100%;
        width: 30px;
        background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
        animation: progressGlow var(--duration, 3.5s) ease-out;
    }

    .progress-percentage {
        text-align: center;
        color: var(--textotabla);
        font-weight: 600;
        font-size: 1.1rem;
        text-shadow: 0 0 10px rgba(52, 211, 153, 0.5);
    }

    .status-indicators {
        display: flex;
        justify-content: space-between;
        gap: 20px;
    }

    .status-item {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 8px;
        flex: 1;
    }

    .status-dot {
        width: 12px;
        height: 12px;
        border-radius: 50%;
        background: rgba(16, 185, 129, 0.3);
        border: 2px solid rgba(16, 185, 129, 0.5);
        transition: all 0.3s ease;
    }

    .status-dot.active {
        background: #10b981;
        border-color: #10b981;
        box-shadow: 0 0 15px rgba(16, 185, 129, 0.8);
        animation: statusPulse 1.5s ease-in-out infinite;
    }

    .status-item span {
        font-size: 0.8rem;
        color: var(--textotabla);
        text-align: center;
    }

    .splash-particles {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
    }

    .particle {
        position: absolute;
        border-radius: 50%;
        animation: particleFloat 8s ease-in-out infinite;
    }

    .green-1 {
        width: 6px;
        height: 6px;
        background: rgba(16, 185, 129, 0.8);
        top: 15%;
        left: 10%;
        animation-delay: 0s;
        box-shadow: 0 0 10px rgba(16, 185, 129, 0.5);
    }

    .green-2 {
        width: 4px;
        height: 4px;
        background: rgba(52, 211, 153, 0.9);
        top: 25%;
        right: 15%;
        animation-delay: 1s;
        animation-duration: 6s;
    }

    .green-3 {
        width: 8px;
        height: 8px;
        background: rgba(110, 231, 183, 0.7);
        top: 60%;
        left: 5%;
        animation-delay: 2s;
        animation-duration: 9s;
    }

    .green-4 {
        width: 5px;
        height: 5px;
        background: rgba(16, 185, 129, 0.6);
        top: 40%;
        right: 8%;
        animation-delay: 3s;
        animation-duration: 7s;
    }

    .green-5 {
        width: 7px;
        height: 7px;
        background: rgba(52, 211, 153, 0.8);
        bottom: 20%;
        left: 20%;
        animation-delay: 4s;
        animation-duration: 8s;
    }

    .green-6 {
        width: 3px;
        height: 3px;
        background: rgba(110, 231, 183, 1);
        bottom: 30%;
        right: 25%;
        animation-delay: 5s;
        animation-duration: 5s;
    }

    .green-7 {
        width: 6px;
        height: 6px;
        background: rgba(16, 185, 129, 0.9);
        top: 70%;
        right: 45%;
        animation-delay: 6s;
        animation-duration: 10s;
    }

    .green-8 {
        width: 4px;
        height: 4px;
        background: rgba(52, 211, 153, 0.7);
        top: 35%;
        left: 45%;
        animation-delay: 7s;
        animation-duration: 6s;
    }

    /* Animaciones */
    @keyframes fadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
    }

    @keyframes waveFloat {
        0%, 100% { transform: translate(0, 0) rotate(0deg); }
        50% { transform: translate(-20px, -30px) rotate(180deg); }
    }

    @keyframes logoEntrance {
        from {
            opacity: 0;
            transform: translateY(40px) scale(0.8);
        }
        to {
            opacity: 1;
            transform: translateY(0) scale(1);
        }
    }

    @keyframes logoFloatSmooth {
        0%, 100% { 
            transform: translateY(0px) rotate(0deg);
        }
        25% {
            transform: translateY(-8px) rotate(0.5deg);
        }
        50% { 
            transform: translateY(-12px) rotate(0deg);
        }
        75% {
            transform: translateY(-8px) rotate(-0.5deg);
        }
    }

    @keyframes portalRotate {
        from { transform: rotate(0deg); }
        to { transform: rotate(360deg); }
    }

    @keyframes portalGlow {
        0% { 
            box-shadow: 0 0 20px rgba(16, 185, 129, 0.5), 
                       inset 0 0 20px rgba(16, 185, 129, 0.2);
        }
        100% { 
            box-shadow: 0 0 40px rgba(16, 185, 129, 0.8), 
                       inset 0 0 30px rgba(52, 211, 153, 0.4);
        }
    }

    @keyframes portalParticleOrbit {
        0% { 
            transform: rotate(0deg) translateX(80px) rotate(0deg);
            opacity: 0;
        }
        10% {
            opacity: 1;
        }
        90% {
            opacity: 1;
        }
        100% { 
            transform: rotate(360deg) translateX(80px) rotate(-360deg);
            opacity: 0;
        }
    }

    @keyframes portalVortex {
        from { transform: rotate(0deg); }
        to { transform: rotate(360deg); }
    }

    @keyframes portalContainerEntrance {
        0% {
            opacity: 0;
            transform: scale(0.5) translateY(50px);
        }
        100% {
            opacity: 1;
            transform: scale(1) translateY(0);
        }
    }

    @keyframes portalRingEntrance {
        0% {
            opacity: 0;
            transform: scale(0.1) rotate(180deg);
        }
        50% {
            opacity: 0.5;
            transform: scale(0.7) rotate(90deg);
        }
        100% {
            opacity: inherit;
            transform: scale(1) rotate(0deg);
        }
    }

    @keyframes portalParticlesEntrance {
        0% {
            opacity: 0;
            transform: scale(0);
        }
        100% {
            opacity: 1;
            transform: scale(1);
        }
    }

    @keyframes portalVortexEntrance {
        0% {
            opacity: 0;
            transform: scale(0) rotate(180deg);
        }
        100% {
            opacity: 1;
            transform: scale(1) rotate(0deg);
        }
    }

    @keyframes portalEmergenceSmooth {
        0% {
            opacity: 0;
            transform: scale(0.1) translateZ(-100px) rotateY(180deg) rotateX(90deg);
            filter: blur(20px) drop-shadow(0 0 80px rgba(16, 185, 129, 1)) brightness(3);
        }
        25% {
            opacity: 0.3;
            transform: scale(0.4) translateZ(-50px) rotateY(135deg) rotateX(45deg);
            filter: blur(15px) drop-shadow(0 0 60px rgba(16, 185, 129, 0.9)) brightness(2.5);
        }
        50% {
            opacity: 0.6;
            transform: scale(0.7) translateZ(-20px) rotateY(90deg) rotateX(20deg);
            filter: blur(8px) drop-shadow(0 0 45px rgba(16, 185, 129, 0.8)) brightness(2);
        }
        75% {
            opacity: 0.85;
            transform: scale(0.9) translateZ(-5px) rotateY(30deg) rotateX(5deg);
            filter: blur(3px) drop-shadow(0 0 35px rgba(16, 185, 129, 0.7)) brightness(1.5);
        }
        100% {
            opacity: 1;
            transform: scale(1) translateZ(0) rotateY(0deg) rotateX(0deg);
            filter: blur(0px) drop-shadow(0 0 30px rgba(16, 185, 129, 0.8)) brightness(1);
        }
    }

    @keyframes textSlideUp {
        from {
            opacity: 0;
            transform: translateY(30px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    @keyframes titleGlow {
        0% { 
            filter: brightness(1) drop-shadow(0 0 20px rgba(16, 185, 129, 0.5));
        }
        100% { 
            filter: brightness(1.2) drop-shadow(0 0 40px rgba(52, 211, 153, 0.8));
        }
    }

    @keyframes underlineExpand {
        from { width: 0; }
        to { width: 100px; }
    }

    @keyframes loadingPulse {
        0%, 100% { opacity: 0.7; }
        50% { opacity: 1; }
    }

    @keyframes progressSlideUp {
        from {
            opacity: 0;
            transform: translateY(40px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    @keyframes progressFill {
        from { width: 0%; }
        to { width: 100%; }
    }

    @keyframes progressGlow {
        from { left: -30px; }
        to { left: 100%; }
    }

    @keyframes statusPulse {
        0%, 100% { transform: scale(1); }
        50% { transform: scale(1.2); }
    }

    @keyframes particleFloat {
        0%, 100% {
            transform: translateY(0px) translateX(0px) rotate(0deg);
            opacity: 0.3;
        }
        25% { 
            transform: translateY(-30px) translateX(20px) rotate(90deg);
            opacity: 0.8;
        }
        50% { 
            transform: translateY(-60px) translateX(-10px) rotate(180deg);
            opacity: 1;
        }
        75% { 
            transform: translateY(-30px) translateX(-30px) rotate(270deg);
            opacity: 0.6;
        }
    }

    @keyframes fadeOut {
        from { 
            opacity: 1;
            transform: scale(1);
        }
        to { 
            opacity: 0;
            transform: scale(1.05);
        }
    }

    .splash-screen.fade-out {
        animation: fadeOut 0.8s ease-out forwards;
        /* Las animaciones del portal continúan durante el fade-out */
    }

    /* Solo detener animaciones cuando sea absolutamente necesario */
    .splash-screen.animations-stopped * {
        animation-play-state: paused !important;
        animation: none !important;
        transition: none !important;
    }

    /* Responsive */
    @media (max-width: 768px) {
        .splash-title {
            font-size: 3rem;
            letter-spacing: 2px;
        }
        
        .splash-subtitle {
            font-size: 1.1rem;
        }
        
        .progress-container {
            max-width: 300px;
        }

        .status-indicators {
            gap: 10px;
        }

        .status-item span {
            font-size: 0.7rem;
        }

        .portal-container {
            width: 250px;
            height: 250px;
        }

        .portal-ring-1 { width: 230px; height: 230px; }
        .portal-ring-2 { width: 190px; height: 190px; }
        .portal-ring-3 { width: 150px; height: 150px; }
        .portal-ring-4 { width: 120px; height: 120px; }
        .portal-ring-5 { width: 90px; height: 90px; }

        .esperanto-flag-svg {
            width: 140px;
            height: 105px;
        }
    }

    @media (max-width: 480px) {
        .splash-title {
            font-size: 2.5rem;
        }
        
        .status-indicators {
            flex-direction: column;
            gap: 15px;
        }

        .status-item {
            flex-direction: row;
            gap: 10px;
        }
    }
</style>

<script define:vars={{ duration }}>
    document.addEventListener('DOMContentLoaded', () => {
        const splashScreen = document.getElementById('splash-screen');
        const progressFill = document.querySelector('.progress-fill');
        const progressGlow = document.querySelector('.progress-glow');
        const progressPercentage = document.querySelector('.progress-percentage');
        const statusDots = document.querySelectorAll('.status-dot');
        
        // Configurar duración de las animaciones
        if (progressFill) {
            progressFill.style.setProperty('--duration', `${duration}ms`);
        }
        if (progressGlow) {
            progressGlow.style.setProperty('--duration', `${duration}ms`);
        }
        
        // Animación del porcentaje
        let currentPercentage = 0;
        const percentageInterval = setInterval(() => {
            currentPercentage += Math.random() * 3;
            if (currentPercentage >= 100) {
                currentPercentage = 100;
                clearInterval(percentageInterval);
            }
            if (progressPercentage) {
                progressPercentage.textContent = Math.floor(currentPercentage) + '%';
            }
        }, duration / 100);
        
        // Activar indicadores de estado
        setTimeout(() => {
            if (statusDots[1]) {
                statusDots[0].classList.remove('active');
                statusDots[1].classList.add('active');
            }
        }, duration * 0.4);
        
        setTimeout(() => {
            if (statusDots[2]) {
                statusDots[1].classList.remove('active');
                statusDots[2].classList.add('active');
            }
        }, duration * 0.8);
        
        // Ocultar splash screen MANTENIENDO las animaciones hasta el fade-out
        setTimeout(() => {
            if (splashScreen) {
                // Aplicar fade out SIN detener animaciones todavía
                splashScreen.classList.add('fade-out');
                
                // Solo detener animaciones al final del fade-out
                setTimeout(() => {
                    // AHORA sí detener todas las animaciones
                    const animatedElements = splashScreen.querySelectorAll('*');
                    animatedElements.forEach(element => {
                        element.style.animationPlayState = 'paused';
                        element.style.animation = 'none';
                        element.style.transition = 'none';
                    });
                    
                    // Ocultar completamente y limpiar
                    splashScreen.style.display = 'none';
                    splashScreen.style.visibility = 'hidden';
                    splashScreen.style.opacity = '0';
                    splashScreen.style.pointerEvents = 'none';
                    
                    // Remover del DOM para evitar efectos residuales
                    if (splashScreen.parentNode) {
                        splashScreen.parentNode.removeChild(splashScreen);
                    }
                    
                    // Disparar evento de finalización
                    document.dispatchEvent(new CustomEvent('splashComplete'));
                }, 800); // Al final del fade-out
            }
        }, duration);
    });
</script>